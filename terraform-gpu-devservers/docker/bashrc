# Source shared environment
[ -f ~/.shell_env ] && source ~/.shell_env

# Function to check for GPU reservation expiry warnings
check_warnings() {
    for warning_file in /home/dev/WARN_EXPIRES_IN_*MIN.txt; do
        if [ -f "$warning_file" ]; then
            # Extract minutes from filename (e.g., WARN_EXPIRES_IN_15MIN.txt -> 15)
            minutes=$(echo "$warning_file" | sed 's/.*WARN_EXPIRES_IN_\([0-9]*\)MIN.txt/\1/')
            echo -e "\033[1;31mðŸš¨ URGENT: Server expires in <${minutes} minutes! ðŸš¨\033[0m"
            return
        fi
    done 2>/dev/null
}

# Run warning check before every command prompt
PROMPT_COMMAND="check_warnings; $PROMPT_COMMAND"

# Bash-specific settings
if [ -f /etc/bash_completion ] && ! shopt -oq posix; then
    . /etc/bash_completion
fi

# Shell selection helper
alias use-zsh='echo "To switch to zsh permanently, run: chsh -s /usr/bin/zsh"'
alias use-bash='echo "Already using bash! To get the full experience, try: zsh"'

# Custom aliases for GPU development
alias gpu-info='nvidia-smi'
alias gpu-watch='watch -n 1 nvidia-smi'
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'